---
import { getCollection, type CollectionEntry } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const photos = (await getCollection("photography"))
  .sort((a: CollectionEntry<"photography">, b: CollectionEntry<"photography">) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Photography">
  <h1>Photography</h1>

  {photos.length === 0 ? (
    <p>No photos yet. Add them in /admin.</p>
  ) : (
    <div class="gallery">
      {photos.map((photo: CollectionEntry<"photography">) => (
        <figure class="photo">
          <img src={photo.data.image} alt={photo.data.alt ?? photo.data.title} loading="lazy" />
          {(photo.data.caption || photo.data.title) && (
            <figcaption>{photo.data.caption ?? photo.data.title}</figcaption>
          )}
        </figure>
      ))}
    </div>
  )}

  <style>
    .gallery {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 16px;
    }

    @media (max-width: 1100px) {
      .gallery {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 800px) {
      .gallery {
        grid-template-columns: 1fr;
      }
    }

    .photo {
      margin: 0;
    }

    .photo img {
      width: 100%;
      height: auto;
      display: block;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .photo figcaption {
      margin-top: 8px;
      font-size: 0.95em;
      opacity: 0.85;
    }
  </style>
</BaseLayout>
