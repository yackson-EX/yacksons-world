---
import { REVIEW_MEDIA, REVIEW_MEDIA_LABELS } from "../lib/reviews";

const { title = "yacksons.world" } = Astro.props;

const SIDEBAR_LINKS = {
  gameUrl: "https://tournamentofchampions.org",
  musicUrl: "https://open.spotify.com/album/4geYwEY8WVG0cOIoWVza1c?si=etknNOFyQyeHQ-hfkUn7QQ",
};

const sidebarTiles = [
  {
    href: SIDEBAR_LINKS.gameUrl,
    img: "/Tournament-of-Champions-Logo.png",
    label: "Play my shitgame",
    alt: "Play my shitgame",
  },
  {
    href: SIDEBAR_LINKS.musicUrl,
    img: "/Album-Art.jpg",
    label: "Listen to my shitsongs",
    alt: "Listen to my shitsongs",
  },
];

const reviewNav = REVIEW_MEDIA.map((medium) => ({
  medium,
  label: REVIEW_MEDIA_LABELS[medium],
}));
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Jacquard+24&family=EB+Garamond&display=swap"
    />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>{title}</title>
    <style>
      :root { color-scheme: dark; }

      :global(:root),
      :global(html),
      :global(body) {
        margin: 0;
        background: #000;
        color: #fff;
        font-family: "EB Garamond", Garamond, "Times New Roman", serif;
        cursor: url("/cursors/cursor1.cur"),
          url("/cursors/cursor-fallback.png") 2 2,
          url("/cursors/cursor.png") 2 2,
          default;
      }

      :global(html) {
        height: 100%;
      }

      :global(body) {
        min-height: 100vh;
      }

      :global(*) {
        cursor: url("/cursors/cursor1.cur"),
          url("/cursors/cursor-fallback.png") 2 2,
          url("/cursors/cursor.png") 2 2,
          default;
      }

      :global(h1, h2, h3, h4, h5, h6, .nav, .tile-label) {
        font-family: "Jacquard 24", "Palatino Linotype", "Book Antiqua",
          Garamond, "Georgia", "Times New Roman", serif;
        font-weight: 400;
      }

      :global(h1) { font-size: calc(2em + 10px); }
      :global(h2) { font-size: calc(1.5em + 10px); }
      :global(h3) { font-size: calc(1.17em + 10px); }
      :global(h4) { font-size: calc(1em + 10px); }
      :global(h5) { font-size: calc(0.83em + 10px); }
      :global(h6) { font-size: calc(0.67em + 10px); }
      :global(.nav) { font-size: calc(1em + 6px); }
      :global(.tile-label) { font-size: calc(1em + 12px); }

      :global(a) { color: inherit; }

      :global(a),
      :global(a img),
      :global(button),
      :global(.photo-button),
      :global(.photo-button img),
      :global(summary),
      :global(.lightbox-close),
      :global(.lightbox-prev),
      :global(.lightbox-next),
      .tile,
      .menu a {
        cursor: url("/cursors/cursor2.cur"),
          url("/cursors/cursor-fallback.png") 2 2,
          url("/cursors/cursor.png") 2 2,
          pointer !important;
      }

      :global(ul) {
        list-style: none;
        padding-left: 0;
        margin-left: 0;
      }

      :global(li) {
        position: relative;
        padding-left: 18px;
      }

      :global(li)::before {
        content: "âœ¶";
        position: absolute;
        left: 0;
        top: 0;
      }

      .wrap {
        max-width: 900px;
        margin: 0 auto;
        padding: 56px 20px 20px;
      }

      header {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: 24px;
        padding: 12px;
        background: #000;
        border-top: 5px solid rgba(255, 255, 255, 0.35);
        border-left: 5px solid rgba(255, 255, 255, 0.35);
        border-right: 5px solid rgba(255, 255, 255, 0.12);
        border-bottom: 5px solid rgba(255, 255, 255, 0.12);
        box-shadow:
          inset 2px 2px 0 rgba(255, 255, 255, 0.08),
          inset -2px -2px 0 rgba(0, 0, 0, 0.6),
          0 0 0 2px rgba(255, 255, 255, 0.08);
      }

      nav a {
        margin-right: 14px;
        text-decoration: none;
      }

      nav a:hover { text-decoration: underline; }

      .nav { display: flex; align-items: center; gap: 14px; }
      .toplink { text-decoration: none; }
      .toplink:hover { text-decoration: underline; }

      .dropdown { position: relative; }
      .dropdown summary {
        list-style: none;
        cursor: pointer;
        display: block;
        touch-action: manipulation;
      }
      .dropdown summary::-webkit-details-marker {
        display: none;
      }
      .menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #000;
        border: 1px solid rgba(255,255,255,0.25);
        padding: 10px;
        min-width: 160px;
        z-index: 10;
      }
      .menu a { display: block; padding: 6px 0; text-decoration: none; }
      .menu a:hover { text-decoration: underline; }

      .mobile-only { display: none; }
      .desktop-only { display: block; }

      .dropdown:focus-within .menu,
      .dropdown[open] .menu {
        display: block;
      }

      @media (hover: hover) and (pointer: fine) {
        .dropdown:hover .menu {
          display: block;
        }

        .dropdown > summary:hover + .menu {
          display: block;
        }
      }


      .main {
        display: grid;
        grid-template-columns: 1fr 240px;
        gap: 24px;
        margin-top: 24px;
        align-items: start;
        padding: 16px;
        background: #000;
        border-top: 5px solid rgba(255, 255, 255, 0.35);
        border-left: 5px solid rgba(255, 255, 255, 0.35);
        border-right: 5px solid rgba(255, 255, 255, 0.12);
        border-bottom: 5px solid rgba(255, 255, 255, 0.12);
        box-shadow:
          inset 2px 2px 0 rgba(255, 255, 255, 0.08),
          inset -2px -2px 0 rgba(0, 0, 0, 0.6),
          0 0 0 2px rgba(255, 255, 255, 0.08);
      }

      /* Pixel-art helper */
      .pixel {
        image-rendering: pixelated;
        image-rendering: crisp-edges;
      }

      /* Logo: preserve aspect ratio, do not force square */
      .logo {
        height: 64px;
        width: auto;
        display: block;
      }

      /* Sidebar tiles */
      .side a {
        display: block;
        margin-bottom: 16px;
        text-decoration: none;
      }

      .side a.tile {
        margin-top: 30px;
      }

      .side {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
      }

      .side-title {
        width: 384px;
        max-width: 100%;
        margin-top: -110px;
        margin-bottom: 12px;
        margin-right: -40px;
        transform: translate(-35px, -15px);
      }

      .side-title img {
        width: 100%;
        height: auto;
        display: block;
      }

      .tile {
        width: 160px;
        max-width: 100%;
      }

      .tile img {
        width: 160px;
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
      }

      .tile-label {
        margin-top: 8px;
        font-size: inherit;
        opacity: 0.9;
        text-align: center;
      }

      @media (max-width: 800px) {
        .main { grid-template-columns: 1fr; }
        .tile { width: 100%; }
      }

      @media (max-width: 700px) {
        .wrap {
          padding: 40px 16px 20px;
        }

        header {
          flex-direction: column;
          align-items: flex-start;
          gap: 12px;
        }

        .nav {
          flex-wrap: nowrap;
          gap: 10px 14px;
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
          scrollbar-width: auto;
          scrollbar-color: #ffffff #1a1a1a;
        }

        .nav > * {
          flex: 0 0 auto;
        }

        .nav::-webkit-scrollbar {
          height: 10px;
        }

        .nav::-webkit-scrollbar-track {
          background: #1a1a1a;
          border: 1px solid rgba(255, 255, 255, 0.25);
        }

        .nav::-webkit-scrollbar-thumb {
          background: linear-gradient(180deg, #f2f2f2 0%, #cfcfcf 100%);
          border: 1px solid rgba(0, 0, 0, 0.4);
          box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.5);
        }

        .dropdown .menu {
          position: static;
          border: 0;
          padding: 6px 0 0;
          min-width: auto;
        }

        .mobile-only { display: block; }
        .desktop-only { display: none; }

        .main {
          gap: 20px;
          padding: 12px;
        }

        .side {
          align-items: center;
        }

        .side-title {
          width: min(320px, 90vw);
          margin-top: 0;
          margin-right: 0;
        }

        .tile {
          width: min(200px, 70vw);
        }

        .tile img {
          width: 100%;
        }
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <header>
        <a href="/" aria-label="Home">
          <img class="logo pixel" src="/Yacksons-World-Logo.gif" alt="" />
        </a>

        <nav class="nav">
          <div class="dropdown desktop-only">
            <a class="toplink" href="/reviews/">Reviews</a>
            <div class="menu" aria-label="Reviews submenu">
              {reviewNav.map((item) => (
                <a href={`/reviews/${item.medium}/`}>{item.label}</a>
              ))}
            </div>
          </div>

          <details class="dropdown mobile-only">
            <summary class="toplink">Reviews</summary>
            <div class="menu" aria-label="Reviews submenu">
              <a href="/reviews/">All</a>
              {reviewNav.map((item) => (
                <a href={`/reviews/${item.medium}/`}>{item.label}</a>
              ))}
            </div>
          </details>

          <a class="toplink" href="/blog/">Blog</a>
          <a class="toplink" href="/photography/">Photography</a>
          <a class="toplink" href="/chat/">Chat</a>
          <a class="toplink" href="/about/">About</a>
        </nav>

      </header>

      <div class="main">
        <main>
          <slot />
        </main>

        <aside class="side">
          <div class="side-title" aria-hidden="true">
            <img src="/Yacksons-World-Title.png" alt="" />
          </div>
          {sidebarTiles.map((tile) => (
            <a class="tile" href={tile.href} target="_blank" rel="noopener">
              <img src={tile.img} alt={tile.alt} />
              <div class="tile-label">{tile.label}</div>
            </a>
          ))}
        </aside>
      </div>
    </div>
  </body>
</html>
